

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="xlSlim allows you to replace VBA code with Python code. The Python code has access to the same Excel object model." lang="en" name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Replacing VBA with Python &mdash; xlSlim v1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Replacing VBA Event Handling with Python" href="vba_events.html" />
    <link rel="prev" title="Streaming data" href="streaming.html" />
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EC5DSJ2TQ1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EC5DSJ2TQ1');
</script>

     

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> xlSlim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="keyword_args.html">Optional arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="passing_simple_types.html">Passing simple data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="passing_arrays.html">Passing lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="passing_objects.html">Passing Python objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="passing_dicts.html">Passing Python dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="udfs.html">Calling VBA and other Excel add-in functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy.html">numpy Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="series.html">pandas Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataframes.html">pandas DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="subprocess.html">Running Python in a background process</a></li>
<li class="toctree-l1"><a class="reference internal" href="imports.html">Advanced Module Importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic_imports.html">Dynamic Module Importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="http_imports.html">Remote Module Importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="streaming.html">Streaming data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Replacing VBA with Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#easier-code-editing">Easier code editing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-examples">Further examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vba_events.html">Replacing VBA Event Handling with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="menus.html">Adding Context and Ribbon Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="licensing.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../samples/read_json_from_web.html">Read JSON data from a URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/read_csv.html">Read CSV data from a file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/sqlite.html">Using SQLite to analyse data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/yfinance.html">Loading Stock Prices from Yahoo! Finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/pca.html">Principal Components Analysis of Index Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/monte_carlo.html">Monte Carlo Option Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/nlp.html">NLP with Excel and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/stream_kafka_doubles.html">Streaming from Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/pivot_table.html">Creating a Pivot Table using Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/equity_index_options.html">US Equity Index Option Pricing</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/environments.html">Python Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/api.html">Excel Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/data_conversions.html">Data Conversions Between Excel and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/globals.html">Magic Global Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/licensing.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/software_requirements.html">Software Requirements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">xlSlim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Replacing VBA with Python</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/vba_replacement.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="replacing-vba-with-python">
<h1>Replacing VBA with Python<a class="headerlink" href="#replacing-vba-with-python" title="Permalink to this headline">¶</a></h1>
<p>xlSlim allows you to replace VBA code with Python code. The Python code has access to the same objects as VBA so it is usually straightforward to translate VBA code to Python.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This functionality requires a premium licence as a Python environment with the <a class="reference external" href="https://github.com/mhammond/pywin32">pywin32</a> extensions installed is required. Anaconda distributions include pywin32. See <a class="reference internal" href="../reference/licensing.html"><span class="doc">Licensing</span></a></p>
</div>
<p>Let’s start with this very simple VBA subroutine that updates one cell:</p>
<div class="highlight-vbnet notranslate"><div class="highlight"><pre><span></span><span class="k">Public</span><span class="w"> </span><span class="k">Sub</span><span class="w"> </span><span class="nf">VBARules</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="n">ActiveWorkbook</span><span class="p">.</span><span class="n">ActiveSheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">).</span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;VBA Rules!&quot;</span><span class="w"></span>
<span class="k">End</span><span class="w"> </span><span class="k">Sub</span><span class="w"></span>
</pre></div>
</div>
<p>Add the subroutine into a Module:</p>
<a class="reference internal image-reference" href="../_images/vba_simple_function_to_set_cell_value.png"><img alt="VBA function to set cell value" src="../_images/vba_simple_function_to_set_cell_value.png" style="width: 400px;" /></a>
<p>And then add a button calling the VBA macro.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Developer ribbon can be enabled by editing your Ribbon layout under File-&gt;Options-&gt;Customize Ribbon</p>
</div>
<a class="reference internal image-reference" href="../_images/vba_assign_macro_to_button.png"><img alt="Assign VBA function to button" src="../_images/vba_assign_macro_to_button.png" style="width: 400px;" /></a>
<p>When the button is clicked the value of cell B2 is modified:</p>
<a class="reference internal image-reference" href="../_images/vba_simple_function_to_set_cell_value_works.png"><img alt="The VBA code modifies the cell value" src="../_images/vba_simple_function_to_set_cell_value_works.png" style="width: 400px;" /></a>
<p>Accomplishing the same in Python is straightforward. This Python code defines a function that sets the value of one cell:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">XLSLIM_COMAPPFUNC</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">PythonRules</span><span class="p">():</span>
        <span class="n">excel_obj</span> <span class="o">=</span> <span class="n">XLSLIM_COMAPPFUNC</span><span class="p">()</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">excel_obj</span><span class="o">.</span><span class="n">Application</span>
<span class="hll">        <span class="n">app</span><span class="o">.</span><span class="n">ActiveWorkbook</span><span class="o">.</span><span class="n">ActiveSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Python Rules!&quot;</span>
</span></pre></div>
</div>
<p>Notice how the highlighted line is identical to the VBA code, other than the initial “app.”. The Python and VBA code access an identical Excel object model, so the code can be very similar. The <a class="reference internal" href="../reference/globals.html#XLSLIM_COMAPPFUNC" title="XLSLIM_COMAPPFUNC"><code class="xref py py-func docutils literal notranslate"><span class="pre">XLSLIM_COMAPPFUNC()</span></code></a> function is used to gain access to the Excel object model.</p>
<p>Save the Python code as a new file on your PC. I saved the file in my Documents folder.</p>
<p>Register the Python code with this <a class="reference internal" href="../reference/api.html#RegisterPyModule" title="RegisterPyModule"><code class="xref py py-func docutils literal notranslate"><span class="pre">RegisterPyModule()</span></code></a> formula (amending the location to match where you saved the file):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">=</span><span class="n">RegisterPyModule</span><span class="p">(</span><span class="s2">&quot;c:\users</span><span class="se">\r</span><span class="s2">usse\documents</span><span class="se">\v</span><span class="s2">bareplacement.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then add another button to call the Python function:</p>
<a class="reference internal image-reference" href="../_images/vba_assign_python_to_button.png"><img alt="Assign Python function to button" src="../_images/vba_assign_python_to_button.png" style="width: 400px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The names of the Python macro functions do not appear in the list. However, if you type the name correctly the button will be linked to the Python code.</p>
</div>
<p>Clicking on the button edits cell B2 to properly reflect the state of the world!</p>
<a class="reference internal image-reference" href="../_images/vba_python_function_to_set_cell_value_works.png"><img alt="The Python button sets a cell value too" src="../_images/vba_python_function_to_set_cell_value_works.png" style="width: 400px;" /></a>
<div class="section" id="easier-code-editing">
<h2>Easier code editing<a class="headerlink" href="#easier-code-editing" title="Permalink to this headline">¶</a></h2>
<p>While editing your code it will be easiest to run the code from a Python editor so you can rapidly see the results and amend as required.</p>
<p>Edit your Python code to match the code below, the amended lines are highlighted:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="kn">import</span> <span class="nn">win32com.client</span> <span class="k">as</span> <span class="nn">win32</span>
</span>
<span class="n">XLSLIM_COMAPPFUNC</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">PythonRules</span><span class="p">():</span>
<span class="hll">        <span class="k">if</span> <span class="n">XLSLIM_COMAPPFUNC</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span class="hll">                <span class="c1"># Running from Excel</span>
</span><span class="hll">                <span class="n">excel_obj</span> <span class="o">=</span> <span class="n">XLSLIM_COMAPPFUNC</span><span class="p">()</span>
</span><span class="hll">                <span class="n">app</span> <span class="o">=</span> <span class="n">excel_obj</span><span class="o">.</span><span class="n">Application</span>
</span><span class="hll">        <span class="k">else</span><span class="p">:</span>
</span><span class="hll">                <span class="c1"># Running in an editor</span>
</span><span class="hll">                <span class="n">app</span> <span class="o">=</span> <span class="n">win32</span><span class="o">.</span><span class="n">gencache</span><span class="o">.</span><span class="n">EnsureDispatch</span><span class="p">(</span><span class="s2">&quot;Excel.Application&quot;</span><span class="p">)</span>
</span><span class="hll">                <span class="n">app</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class="hll">                <span class="n">app</span><span class="o">.</span><span class="n">Workbooks</span><span class="o">.</span><span class="n">Add</span><span class="p">()</span><span class="o">.</span><span class="n">Activate</span><span class="p">()</span>
</span>
        <span class="n">app</span><span class="o">.</span><span class="n">ActiveWorkbook</span><span class="o">.</span><span class="n">ActiveSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Python Rules!&quot;</span>

<span class="hll"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class="hll">        <span class="n">PythonRules</span><span class="p">()</span>
</span></pre></div>
</div>
<p>This code will now open a new instance of Excel when run from an external editor. When run within Excel the code will behave as before and modify the active Excel instance. This code modification allows the Python code to be run and edited in a very similar manner to VBA code in the VBA editor.</p>
</div>
<div class="section" id="further-examples">
<h2>Further examples<a class="headerlink" href="#further-examples" title="Permalink to this headline">¶</a></h2>
<p>This code shows how to perform common tasks. See <a class="reference internal" href="../samples/pivot_table.html"><span class="doc">Creating a Pivot Table using Python</span></a> for an example how to replace VBA to create a pivot table.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pythoncom</span>
<span class="kn">import</span> <span class="nn">win32com.client</span> <span class="k">as</span> <span class="nn">win32</span>
<span class="kn">from</span> <span class="nn">win32com.client</span> <span class="kn">import</span> <span class="n">constants</span>

<span class="n">XLSLIM_COMAPPFUNC</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">manipulate_excel</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">XLSLIM_COMAPPFUNC</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Running from Excel</span>
                <span class="c1"># Do be careful not to accidentally edit the calling cell</span>
                <span class="n">excel_obj</span> <span class="o">=</span> <span class="n">XLSLIM_COMAPPFUNC</span><span class="p">()</span>
                <span class="n">app</span> <span class="o">=</span> <span class="n">excel_obj</span><span class="o">.</span><span class="n">Application</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Running in an editor</span>
                <span class="c1">#</span>
                <span class="c1"># This could be used instead to connect to a running Excel</span>
                <span class="c1"># app = win32.GetActiveObject(&quot;Excel.Application&quot;)</span>
                <span class="c1"># however the gencache versions gives a better editing experience</span>
                <span class="c1"># as methods and properties are then known in the editor</span>
                <span class="n">app</span> <span class="o">=</span> <span class="n">win32</span><span class="o">.</span><span class="n">gencache</span><span class="o">.</span><span class="n">EnsureDispatch</span><span class="p">(</span><span class="s2">&quot;Excel.Application&quot;</span><span class="p">)</span>
                <span class="n">app</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">app</span><span class="o">.</span><span class="n">Workbooks</span><span class="o">.</span><span class="n">Add</span><span class="p">()</span><span class="o">.</span><span class="n">Activate</span><span class="p">()</span>

        <span class="c1"># Cells can be referenced in various ways</span>
        <span class="n">app</span><span class="o">.</span><span class="n">ActiveWorkbook</span><span class="o">.</span><span class="n">ActiveSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Python Rules!&quot;</span>
        <span class="c1"># Names can be used too, commented out now as Book1 easily becomes Book2</span>
        <span class="c1"># app.Workbooks(&quot;Book1&quot;).Sheets(&quot;Sheet1&quot;).Cells(2, 1).Value = &quot;Python Rules!&quot;</span>
        <span class="n">app</span><span class="o">.</span><span class="n">Workbooks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Sheets</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Python Rules!&quot;</span>

        <span class="c1"># Creating variables for books and sheets makes the code neater</span>
        <span class="n">xlBook</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Workbooks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">xlSheet</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Sheets</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">xlSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Python Rules!&quot;</span>

        <span class="c1"># Handling datetimes</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">())</span>
        <span class="n">time_object</span> <span class="o">=</span> <span class="n">pythoncom</span><span class="o">.</span><span class="n">MakeTime</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
        <span class="n">xlSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">time_object</span>

        <span class="c1"># Setting a formula</span>
        <span class="n">xlSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Formula</span> <span class="o">=</span> <span class="s2">&quot;=UPPER(A2)&quot;</span>

        <span class="c1"># Clear a cell</span>
        <span class="n">xlSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Ranges can be set in various ways</span>
        <span class="n">range1</span> <span class="o">=</span> <span class="n">xlSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># one-cell range</span>
        <span class="n">range2</span> <span class="o">=</span> <span class="n">xlSheet</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;B5:C10&quot;</span><span class="p">)</span>  <span class="c1"># excel notation</span>
        <span class="n">range3</span> <span class="o">=</span> <span class="n">xlSheet</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="n">xlSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">xlSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">range3</span><span class="o">.</span><span class="n">Interior</span><span class="o">.</span><span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">7</span>

        <span class="c1"># Set range data</span>
        <span class="n">range3</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="c1"># Call a function - sort range - note the use of constants</span>
        <span class="n">range3</span><span class="o">.</span><span class="n">Sort</span><span class="p">(</span>
                <span class="n">Key1</span><span class="o">=</span><span class="n">xlSheet</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;C3&quot;</span><span class="p">),</span>
                <span class="n">Order1</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">xlAscending</span><span class="p">,</span>
                <span class="n">Orientation</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">xlSortColumns</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;Done&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
        <span class="n">manipulate_excel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vba_events.html" class="btn btn-neutral float-right" title="Replacing VBA Event Handling with Python" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="streaming.html" class="btn btn-neutral float-left" title="Streaming data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022-2023, Russel Webber

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>