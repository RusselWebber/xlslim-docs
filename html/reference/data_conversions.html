

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="The reference page showing how xlSlim converts data between Excel and Python. Also shows how type hints affect these conversions." lang="en" name="description" xml:lang="en" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data Conversions Between Excel and Python &mdash; xlSlim v1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
    <link rel="canonical" href="https://russelwebber.github.io/xlslim-docs/html/reference/data_conversions.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=e160b93e"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Magic Global Functions" href="globals.html" />
    <link rel="prev" title="Excel Functions" href="api.html" />
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EC5DSJ2TQ1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EC5DSJ2TQ1');
</script>

     

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            xlSlim
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/interactive.html">Interactive Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/keyword_args.html">Optional arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_simple_types.html">Passing simple data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_arrays.html">Passing lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_objects.html">Passing Python objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_dicts.html">Passing Python dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/udfs.html">Calling VBA and other Excel add-in functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/numpy.html">numpy Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/series.html">pandas Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/dataframes.html">pandas DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/subprocess.html">Running Python in a background process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/imports.html">Advanced Module Importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/dynamic_imports.html">Dynamic Module Importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/http_imports.html">Remote Module Importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/streaming.html">Streaming data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/vba_replacement.html">Replacing VBA with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/vba_events.html">Replacing VBA Event Handling with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/menus.html">Adding Context and Ribbon Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/licensing.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/duckdb.html">DuckDB</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../samples/read_json_from_web.html">Read JSON data from a URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/read_csv.html">Read CSV data from a file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/sqlite.html">Using SQLite to analyse data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/yfinance.html">Loading Stock Prices from Yahoo! Finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/pca.html">Principal Components Analysis of Index Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/monte_carlo.html">Monte Carlo Option Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/nlp.html">NLP with Excel and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/stream_kafka_doubles.html">Streaming from Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/pivot_table.html">Creating a Pivot Table using Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/equity_index_options.html">US Equity Index Option Pricing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="environments.html">Python Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Excel Functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Conversions Between Excel and Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#function-inputs">Function Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-outputs">Function Outputs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="globals.html">Magic Global Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ranges.html">Special Named Ranges</a></li>
<li class="toctree-l1"><a class="reference internal" href="licensing.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="software_requirements.html">Software Requirements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">xlSlim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Data Conversions Between Excel and Python</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/data_conversions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-conversions-between-excel-and-python">
<h1>Data Conversions Between Excel and Python<a class="headerlink" href="#data-conversions-between-excel-and-python" title="Link to this heading"></a></h1>
<p>xlSlim always tries to determine the appropriate conversions when passing data between Excel and Python. Without type hints xlSlim will handle numbers, strings, bools and datetimes. Adding type hints allows xlSlim to handle Python dictionaries and instances of custom classes. Lists of simple data types are also better handled when type hints are provided.</p>
<p>See <a class="reference internal" href="../user/passing_simple_types.html"><span class="doc">Passing simple data types</span></a>, <a class="reference internal" href="../user/passing_objects.html"><span class="doc">Passing Python objects</span></a>, <a class="reference internal" href="../user/passing_dicts.html"><span class="doc">Passing Python dictionaries</span></a>, <a class="reference internal" href="../user/passing_arrays.html"><span class="doc">Passing lists</span></a>, <a class="reference internal" href="../user/numpy.html"><span class="doc">numpy Arrays</span></a>, <a class="reference internal" href="../user/series.html"><span class="doc">pandas Series</span></a> and <a class="reference internal" href="../user/dataframes.html"><span class="doc">pandas DataFrames</span></a> for worked examples.</p>
<section id="function-inputs">
<h2>Function Inputs<a class="headerlink" href="#function-inputs" title="Link to this heading"></a></h2>
<p>Python functions without type hints are handled well enough for many use cases.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Data Type Conversions Without Type Hints</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type in Excel</p></th>
<th class="head"><p>Type passed to Python</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>double</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-even"><td><p>string</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-odd"><td><p>bool</p></td>
<td><p>bool</p></td>
</tr>
<tr class="row-even"><td><p>datetime</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>Range</p></td>
<td><p>Wrapped .Net array of objects.</p></td>
</tr>
</tbody>
</table>
<p>For more advanced use cases, Python type hints open up the full potential of xlSlim.</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Data Type Conversions With Type Hints</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 22.2%" />
<col style="width: 22.2%" />
<col style="width: 55.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type in Excel</p></th>
<th class="head"><p>Type passed to Python</p></th>
<th class="head"><p>Supported Type Hints</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>integer</p></td>
<td><ul class="simple">
<li><p>int</p></li>
<li><p>Optional[int]</p></li>
<li><p>Union[int, None]</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>double</p></td>
<td><p>float</p></td>
<td><ul class="simple">
<li><p>float</p></li>
<li><p>Optional[float]</p></li>
<li><p>Union[float, None]</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>string</p></td>
<td><p>string</p></td>
<td><ul class="simple">
<li><p>str</p></li>
<li><p>Optional[str]</p></li>
<li><p>Union[str, None]</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>bool</p></td>
<td><p>bool</p></td>
<td><ul class="simple">
<li><p>bool</p></li>
<li><p>Optional[bool]</p></li>
<li><p>Union[bool, None]</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>datetime</p></td>
<td><p>datetime</p></td>
<td><ul class="simple">
<li><p>datetime.datetime</p></li>
<li><p>Optional[datetime.datetime]</p></li>
<li><p>Union[datetime.datetime, None]</p></li>
<li><p>datetime.date</p></li>
<li><p>Optional[datetime.date]</p></li>
<li><p>Union[datetime.date, None]</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>cached object handle</p></td>
<td><p>Python object</p></td>
<td><ul class="simple">
<li><p><em>Any Python class</em></p></li>
<li><p>Dict</p></li>
<li><p>np.ndarray</p></li>
<li><p>pd.Series</p></li>
<li><p>pd.DataFrame</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Range of ints</p></td>
<td><p>Wrapped .Net array of objects.</p></td>
<td><ul class="simple">
<li><p>List[int]</p></li>
<li><p>Iterable[int]</p></li>
<li><p>Optional[List[int]]</p></li>
<li><p>Optional[Iterable[int]]</p></li>
<li><p>Union[List[int], None]</p></li>
<li><p>Union[Iterable[int], None]</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Range of doubles</p></td>
<td><p>Wrapped .Net array of doubles.</p></td>
<td><ul class="simple">
<li><p>List[float]</p></li>
<li><p>Iterable[float]</p></li>
<li><p>Optional[List[float]]</p></li>
<li><p>Optional[Iterable[float]]</p></li>
<li><p>Union[List[float], None]</p></li>
<li><p>Union[Iterable[float], None]</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Range of strings</p></td>
<td><p>Wrapped .Net array of objects.</p></td>
<td><ul class="simple">
<li><p>List[str]</p></li>
<li><p>Iterable[str]</p></li>
<li><p>Optional[List[str]]</p></li>
<li><p>Optional[Iterable[str]]</p></li>
<li><p>Union[List[str], None]</p></li>
<li><p>Union[Iterable[str], None]</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Range of datetimes</p></td>
<td><p>Wrapped .Net array of objects.</p></td>
<td><ul class="simple">
<li><p>List[datetime.datetime]</p></li>
<li><p>List[datetime.date]</p></li>
<li><p>Iterable[datetime.datetime]</p></li>
<li><p>Iterable[datetime.date]</p></li>
<li><p>Optional[List[datetime.datetime]]</p></li>
<li><p>Optional[List[datetime.date]]</p></li>
<li><p>Optional[Iterable[datetime.datetime]]</p></li>
<li><p>Optional[Iterable[datetime.date]]</p></li>
<li><p>Union[List[datetime.datetime], None]</p></li>
<li><p>Union[List[datetime.date], None]</p></li>
<li><p>Union[Iterable[datetime.datetime], None]</p></li>
<li><p>Union[Iterable[datetime.date], None]</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Range</p></td>
<td><p>np.ndarray</p></td>
<td><p>np.ndarray</p></td>
</tr>
<tr class="row-odd"><td><dl class="simple">
<dt>Range</dt><dd><ul class="simple">
<li><p>first column is the index</p></li>
<li><p>second column is the data</p></li>
</ul>
</dd>
</dl>
</td>
<td><p>pd.Series</p></td>
<td><p>pd.Series</p></td>
</tr>
<tr class="row-even"><td><dl class="simple">
<dt>Range</dt><dd><ul class="simple">
<li><p>first column is the index</p></li>
<li><p>first row is the column names</p></li>
<li><p>the top left cell is ignored</p></li>
</ul>
</dd>
</dl>
</td>
<td><p>pd.DataFrame</p></td>
<td><p>pd.DataFrame</p></td>
</tr>
<tr class="row-odd"><td><p>Range of cached object handles</p></td>
<td><p>List of Python objects</p></td>
<td><ul class="simple">
<li><p>List[<em>Any Python class</em>]</p></li>
<li><p>Iterable[<em>Any Python class</em>]</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Range of cached object handles</p></td>
<td><p>List of np.ndarray</p></td>
<td><ul class="simple">
<li><p>List[np.ndarray]</p></li>
<li><p>Iterable[np.ndarray]</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Range of cached object handles</p></td>
<td><p>List of pd.Series</p></td>
<td><ul class="simple">
<li><p>List[pd.Series]</p></li>
<li><p>Iterable[pd.Series]</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Range of cached object handles</p></td>
<td><p>List of pd.DataFrame</p></td>
<td><ul class="simple">
<li><p>List[pd.DataFrame]</p></li>
<li><p>Iterable[pd.DataFrame]</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Python wrapped .Net arrays are not converted to native Python lists for performance reasons. The wrapped arrays behave exactly the same as native Python lists with one important difference - they are immutable. Additionally, type checking is only done when a function expects a list of floats, in other cases lists of objects are passed and the objects may be any Excel type.</p>
</div>
</section>
<section id="function-outputs">
<h2>Function Outputs<a class="headerlink" href="#function-outputs" title="Link to this heading"></a></h2>
<p>The results of Python functions are handled equally well with or without type hints.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Data Type Conversions</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type in Python</p></th>
<th class="head"><p>Result type in Excel</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>double</p></td>
</tr>
<tr class="row-odd"><td><p>float</p></td>
<td><p>double</p></td>
</tr>
<tr class="row-even"><td><p>bool</p></td>
<td><p>bool</p></td>
</tr>
<tr class="row-odd"><td><p>datetime</p></td>
<td><p>float (this is correct as all Excel datetimes are floats)</p></td>
</tr>
<tr class="row-even"><td><p>string</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-odd"><td><p>dict</p></td>
<td><p>cached object handle</p></td>
</tr>
<tr class="row-even"><td><p>Python object (an instance of a custom class)</p></td>
<td><p>cached object handle</p></td>
</tr>
<tr class="row-odd"><td><p>np.ndarray</p></td>
<td><p>cached object handle</p></td>
</tr>
<tr class="row-even"><td><p>pd.Series</p></td>
<td><p>cached object handle</p></td>
</tr>
<tr class="row-odd"><td><p>pd.DataFrame</p></td>
<td><p>cached object handle</p></td>
</tr>
<tr class="row-even"><td><p>list of integers</p></td>
<td><p>Range of doubles</p></td>
</tr>
<tr class="row-odd"><td><p>list of floats</p></td>
<td><p>Range of doubles</p></td>
</tr>
<tr class="row-even"><td><p>list of bool</p></td>
<td><p>Range of bool</p></td>
</tr>
<tr class="row-odd"><td><p>list of strings</p></td>
<td><p>Range of strings</p></td>
</tr>
<tr class="row-even"><td><p>list of strings, ints, floats and bools</p></td>
<td><p>Range of strings, ints, floats and bools</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api.html" class="btn btn-neutral float-left" title="Excel Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="globals.html" class="btn btn-neutral float-right" title="Magic Global Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025, Russel Webber.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>