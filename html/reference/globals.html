

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="xlSlim uses several magic global functions to allow access to the Excel internals, including access to the COM object model." lang="en" name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Magic Global Functions &mdash; xlSlim v1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Licensing" href="licensing.html" />
    <link rel="prev" title="Data Conversions Between Excel and Python" href="data_conversions.html" />
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EC5DSJ2TQ1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EC5DSJ2TQ1');
</script>

     

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> xlSlim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/keyword_args.html">Optional arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_simple_types.html">Passing simple data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_arrays.html">Passing lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_objects.html">Passing Python objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/passing_dicts.html">Passing Python dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/udfs.html">Calling VBA and other Excel add-in functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/numpy.html">numpy Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/series.html">pandas Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/dataframes.html">pandas DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/subprocess.html">Running Python in a background process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/imports.html">Advanced Module Importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/streaming.html">Streaming data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/vba_replacement.html">Replacing VBA with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/licensing.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../samples/read_json_from_web.html">Read JSON data from a URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/read_csv.html">Read CSV data from a file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/sqlite.html">Using SQLite to analyse data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/yfinance.html">Loading Stock Prices from Yahoo! Finance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/pca.html">Principal Components Analysis of Index Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/monte_carlo.html">Monte Carlo Option Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/nlp.html">NLP with Excel and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/stream_kafka_doubles.html">Streaming from Kafka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/pivot_table.html">Creating a Pivot Table using Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../samples/equity_index_options.html">US Equity Index Option Pricing</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="environments.html">Python Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Excel Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_conversions.html">Data Conversions Between Excel and Python</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Magic Global Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="licensing.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="software_requirements.html">Software Requirements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">xlSlim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Magic Global Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/reference/globals.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="magic-global-functions">
<h1>Magic Global Functions<a class="headerlink" href="#magic-global-functions" title="Permalink to this headline">¶</a></h1>
<p>xlSlim has four magic global functions that are always available in Python code running within xlSlim: <a class="reference internal" href="#XLSLIM_UDFFUNC" title="XLSLIM_UDFFUNC"><code class="xref py py-func docutils literal notranslate"><span class="pre">XLSLIM_UDFFUNC()</span></code></a>, <a class="reference internal" href="#XLSLIM_INWINDOWFUNC" title="XLSLIM_INWINDOWFUNC"><code class="xref py py-func docutils literal notranslate"><span class="pre">XLSLIM_INWINDOWFUNC()</span></code></a>, <a class="reference internal" href="#XLSLIM_COMAPPFUNC" title="XLSLIM_COMAPPFUNC"><code class="xref py py-func docutils literal notranslate"><span class="pre">XLSLIM_COMAPPFUNC()</span></code></a> and <a class="reference internal" href="#XLSLIM_CALLERFUNC" title="XLSLIM_CALLERFUNC"><code class="xref py py-func docutils literal notranslate"><span class="pre">XLSLIM_CALLERFUNC()</span></code></a>.</p>
<dl class="function">
<dt id="XLSLIM_UDFFUNC">
<code class="descname">XLSLIM_UDFFUNC</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#XLSLIM_UDFFUNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This global function can be used to access VBA functions as well as functions defined in other Excel add-ins.</p>
<p>An example is this function that calls the <cite>EUROCONVERT()</cite> Excel add-in function. See <a class="reference internal" href="../user/udfs.html"><span class="doc">Calling VBA and other Excel add-in functions</span></a> for a detailed example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eur_conversion</span><span class="p">(</span><span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">from_currency</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">to_currency</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Convert to EUR using the Excel addin function EUROCONVERT.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XLSLIM_UDFFUNC</span><span class="p">(</span><span class="s2">&quot;EUROCONVERT&quot;</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">from_currency</span><span class="p">,</span> <span class="n">to_currency</span><span class="p">)</span>
</pre></div>
</div>
<dl class="function">
<dt id="XLSLIM_INWINDOWFUNC">
<code class="descname">XLSLIM_INWINDOWFUNC</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#XLSLIM_INWINDOWFUNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This global function can be used to check if the code is running while the user has the Excel Function Wizard open. In some cases, such as if the code is slow or has side effects, you may wish to not execute the function when the Function Wizard is open.</p>
<p>This Python code shows how it can be used to control which path a function executes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">XLSLIM_INWINDOWFUNC</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">slow_func</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">XLSLIM_INWINDOWFUNC</span><span class="p">():</span>
                <span class="k">return</span> <span class="s2">&quot;Fast result&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;Slow result&quot;</span>
</pre></div>
</div>
<p>When in the Excel Function Wizard the Python code returns “Fast result”.</p>
<a class="reference internal image-reference" href="../_images/global_function_in_func_wizard.png"><img alt="Function in Excel Function Wizard" src="../_images/global_function_in_func_wizard.png" style="width: 400px;" /></a>
<p>Else the Python code returns “Slow result”.</p>
<a class="reference internal image-reference" href="../_images/global_function_not_in_func_wizard.png"><img alt="Function not in Excel Function Wizard" src="../_images/global_function_not_in_func_wizard.png" style="width: 400px;" /></a>
<dl class="function">
<dt id="XLSLIM_COMAPPFUNC">
<code class="descname">XLSLIM_COMAPPFUNC</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#XLSLIM_COMAPPFUNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This global function can be used to access the calling Excel application via COM. This is usually used when automating Excel or replacing VBA code.</p>
<p>An example is this function that sets a cell value. See <a class="reference internal" href="../user/vba_replacement.html"><span class="doc">Replacing VBA with Python</span></a> and <a class="reference internal" href="../samples/pivot_table.html"><span class="doc">Creating a Pivot Table using Python</span></a> for detailed examples.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">XLSLIM_COMAPPFUNC</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">PythonRules</span><span class="p">():</span>
        <span class="n">excel_obj</span> <span class="o">=</span> <span class="n">XLSLIM_COMAPPFUNC</span><span class="p">()</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">excel_obj</span><span class="o">.</span><span class="n">Application</span>
        <span class="n">app</span><span class="o">.</span><span class="n">ActiveWorkbook</span><span class="o">.</span><span class="n">ActiveSheet</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;Python Rules!&quot;</span>
</pre></div>
</div>
<dl class="function">
<dt id="XLSLIM_CALLERFUNC">
<code class="descname">XLSLIM_CALLERFUNC</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#XLSLIM_CALLERFUNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This global function can be used to find the address of the cell calling Python.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">XLSLIM_CALLERFUNC</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">WhoCalledMe</span><span class="p">():</span>
        <span class="n">caller</span> <span class="o">=</span> <span class="n">XLSLIM_CALLERFUNC</span><span class="p">()</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;I was called by (</span><span class="si">{</span><span class="n">caller</span><span class="o">.</span><span class="n">RowFirst</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">caller</span><span class="o">.</span><span class="n">ColumnFirst</span><span class="si">}</span><span class="s2">), (</span><span class="si">{</span><span class="n">caller</span><span class="o">.</span><span class="n">RowLast</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">caller</span><span class="o">.</span><span class="n">ColumnLast</span><span class="si">}</span><span class="s2">)&quot;</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="licensing.html" class="btn btn-neutral float-right" title="Licensing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="data_conversions.html" class="btn btn-neutral float-left" title="Data Conversions Between Excel and Python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Russel Webber

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>